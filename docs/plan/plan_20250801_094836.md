# 「What's New」タグ削除および空タグ修正の実装計画

## 計画作成日時
2025-08-01 09:48:36

## 概要
ユーザーの要望に基づき、「What's New」タグを削除し、併せて空のタグ問題も解決する。

## 背景
- 空のタグ（""）が20記事に設定されている
- 「What's New」タグも同じ20記事に設定されている
- すべてAWSのWhat's Newフィードから取得した記事
- 「What's New」タグは「新機能」タグと100%重複しており、不要と判断

## 実装方針

### Phase 1: 既存データのクリーンアップ
1. 空のタグを削除
2. 「What's New」タグを削除

### Phase 2: 再発防止のためのコード修正
AWSフェッチャーを修正して、今後同様の問題が発生しないようにする。

## 詳細実装タスク

### 1. 空のタグの削除（優先度: 最高）
**実行内容:**
- 既存スクリプト `fix-empty-tags.ts` を実行
- 20記事から空のタグを切り離し
- 空のタグをデータベースから削除

**実行コマンド:**
```bash
npx tsx scripts/fix-empty-tags.ts
```

### 2. 「What's New」タグの削除（優先度: 高）
**実装内容:**
- 新規スクリプト `remove-whats-new-tag.ts` を作成
- 20記事から「What's New」タグを切り離し
- 「What's New」タグをデータベースから削除

**スクリプトの機能:**
```typescript
// 主要機能
- What's Newタグの検索
- 関連記事からのタグ切り離し
- タグの削除
- 実行結果の報告
```

### 3. AWSフェッチャーの修正（優先度: 高）
**修正ファイル:** `/home/tomoaki/work/techtrend/lib/fetchers/aws.ts`

**修正内容:**

#### 3.1 空文字列のフィルタリング（132-134行目）
```typescript
// 修正前
if (item.categories && item.categories.length > 0) {
  tags.push(...item.categories);
}

// 修正後
if (item.categories && item.categories.length > 0) {
  const validCategories = item.categories
    .filter(cat => cat && cat.trim().length > 0)
    .map(cat => cat.trim());
  tags.push(...validCategories);
}
```

#### 3.2 「What's New」タグの削除（74-82行目）
```typescript
// 修正前
const sourceMap: Record<string, string> = {
  'Security': 'Security Bulletins',
  'WhatsNew': "What's New",
  'Blog': 'News Blog'
};

// 修正後
const sourceMap: Record<string, string> = {
  'Security': 'Security Bulletins',
  // 'WhatsNew': "What's New", // 削除：新機能タグと重複するため
  'Blog': 'News Blog'
};
```

## ファイル変更計画

### 新規作成
1. `/home/tomoaki/work/techtrend/scripts/remove-whats-new-tag.ts`
   - 「What's New」タグ削除スクリプト
   - 約150行程度

### 修正
1. `/home/tomoaki/work/techtrend/lib/fetchers/aws.ts`
   - 空文字列フィルタリング追加
   - 「What's New」タグ付与の削除
   - 約10行の修正

### 既存（実行のみ）
1. `/home/tomoaki/work/techtrend/scripts/fix-empty-tags.ts`
   - 空のタグ削除スクリプト（作成済み）

## テスト戦略

### 1. データベース確認
- 空のタグが削除されたことを確認
- 「What's New」タグが削除されたことを確認
- 記事の他のタグが影響を受けていないことを確認

### 2. AWSフェッチャーのテスト
- 新規記事取得時に空のタグが作成されないことを確認
- 「What's New」タグが付与されないことを確認
- 「新機能」タグは引き続き付与されることを確認

### 3. UI確認
- タグ表示が正常であることを確認
- タグによるフィルタリングが正常に動作することを確認

## リスク分析と対策

### リスク1: データの不整合
- **影響**: 最小（タグのみの変更で記事内容には影響なし）
- **対策**: 実行前にデータベースの現状を記録

### リスク2: UIへの影響
- **影響**: 空のタグが表示されなくなる（改善）
- **対策**: 特になし（望ましい変更）

### リスク3: 将来のAWS記事の識別
- **影響**: 「新機能」タグで十分に識別可能
- **対策**: 特になし

## 実行計画

### 実行順序
1. 空のタグ削除スクリプトの実行（5分）
2. 「What's New」タグ削除スクリプトの作成と実行（30分）
3. AWSフェッチャーの修正（15分）
4. 動作確認（15分）

### 総所要時間
約1時間

## 成功基準
1. 空のタグがデータベースから完全に削除される
2. 「What's New」タグがデータベースから完全に削除される
3. 新規AWS記事取得時に問題のあるタグが作成されない
4. UIでタグ表示が改善される

## 次のステップ
1. remove-whats-new-tag.ts の実装
2. fix-empty-tags.ts の実行
3. remove-whats-new-tag.ts の実行
4. aws.ts の修正
5. 動作確認

---
計画作成者: Claude Code
計画バージョン: 1.0